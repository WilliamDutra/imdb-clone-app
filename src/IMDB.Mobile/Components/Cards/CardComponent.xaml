<?xml version="1.0" encoding="utf-8" ?>
<ContentView
    x:Class="IMDB.Mobile.Components.Cards.CardComponent"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:controls="clr-namespace:XGENO.Maui.Controls;assembly=Maui.Controls.RatingView"
    xmlns:ffimageloading="clr-namespace:FFImageLoading.Maui;assembly=FFImageLoading.Maui"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    x:Name="this">

    <Grid BindingContext="{x:Reference this}">
        <Grid
            BackgroundColor="{StaticResource Gray200}"
            WidthRequest="{Binding CardWidth}"
            ZIndex="1">
            <Grid.Triggers>
                <DataTrigger
                    Binding="{Binding IsLoading}"
                    TargetType="Grid"
                    Value="False">
                    <Setter Property="IsVisible" Value="False" />
                </DataTrigger>
            </Grid.Triggers>
        </Grid>


        <Grid RowSpacing="10" WidthRequest="{Binding CardWidth}">
            <Grid.RowDefinitions>
                <RowDefinition />
                <RowDefinition />
                <RowDefinition />
            </Grid.RowDefinitions>

            <Border
                Grid.Row="0"
                Background="{StaticResource ColorTertiary}"
                Stroke="{StaticResource ColorTertiary}"
                StrokeThickness="4">

                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="20" />
                </Border.StrokeShape>
                <VerticalStackLayout>

                    <Grid>
                        <ffimageloading:CachedImage
                            Aspect="AspectFill"
                            CacheDuration="30"
                            DownsampleToViewSize="True"
                            ErrorPlaceholder="erro_icon_thumb_not_load.png"
                            HeightRequest="{Binding CardHeight}"
                            Source="{Binding Image}" />

                        <Image
                            Margin="10"
                            HorizontalOptions="End"
                            Source="bookmark_icon_full.png"
                            VerticalOptions="Start">
                            <Image.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding AddToListCommand}" CommandParameter="{Binding AddToListCommandParameter}" />
                            </Image.GestureRecognizers>
                            <Image.Behaviors>
                                <toolkit:IconTintColorBehavior TintColor="{StaticResource ColorSecondary}" />
                            </Image.Behaviors>
                        </Image>

                    </Grid>

                </VerticalStackLayout>
            </Border>

            <Label
                Grid.Row="1"
                Style="{StaticResource CardTitle}"
                Text="{Binding Title}" />

            <HorizontalStackLayout Grid.Row="2" Spacing="10">

                <Label Style="{StaticResource RatingNote}" Text="{Binding Rating}" />

                <controls:RatingView
                    HorizontalOptions="Start"
                    ItemCount="1"
                    ItemSize="16"
                    RatedFillColor="{StaticResource ColorSecondary}"
                    StrokeColor="Black"
                    StrokeWidth="1"
                    UnRatedFillColor="LightGrey"
                    Value="{Binding Rating}" />

            </HorizontalStackLayout>


        </Grid>

    </Grid>
</ContentView>
